/*
Template Name: HUD - Responsive Bootstrap 5 Admin Template
Version: 1.4.0
Author: Sean Ngu
Website: http://www.seantheme.com/hud/
	----------------------------
		APPS CONTENT TABLE
	----------------------------

	<!-- ======== GLOBAL SCRIPT SETTING ======== -->
  01. Global Variable
  02. Handle Scrollbar
  03. Handle Sidebar Menu
  04. Handle Sidebar Scroll Memory
  05. Handle Card Action
  06. Handle Tooltip & Popover Activation
  07. Handle Scroll to Top Button
  08. Handle hexToRgba
  09. Handle Scroll To
  10. Handle Toggle Class
  11. Handle Theme Panel
  12. Application Controller
  13. Initialise
	
	<!-- ======== APPLICATION SETTING ======== -->
	Application Controller
*/

/* 01. Global Variable
------------------------------------------------ */
var app = {
  id: "#app",
  isMobile:
    /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(
      navigator.userAgent
    ) || window.innerWidth < 992,
  bootstrap: {
    tooltip: {
      attr: 'data-bs-toggle="tooltip"',
    },
    popover: {
      attr: 'data-bs-toggle="popover"',
    },
    modal: {
      attr: 'data-bs-toggle="modal"',
      dismissAttr: 'data-bs-dismiss="modal"',
      event: {
        hidden: "hidden.bs.modal",
      },
    },
    nav: {
      class: "nav",
      tabs: {
        class: "nav-tabs",
        activeClass: "active",
        itemClass: "nav-item",
        itemLinkClass: "nav-link",
      },
    },
  },
  header: {
    id: "#header",
    class: "app-header",
    hasScrollClass: "has-scroll",
  },
  sidebar: {
    id: "#sidebar",
    class: "app-sidebar",
    scrollBar: {
      localStorage: "appSidebarScrollPosition",
      dom: "",
    },
    menu: {
      class: "menu",
      initAttr: "data-init",
      animationTime: 0,
      itemClass: "menu-item",
      itemLinkClass: "menu-link",
      hasSubClass: "has-sub",
      activeClass: "active",
      expandingClass: "expanding",
      expandClass: "expand",
      submenu: {
        class: "menu-submenu",
      },
    },
    mobile: {
      toggleAttr: 'data-toggle="app-sidebar-mobile"',
      dismissAttr: 'data-dismiss="app-sidebar-mobile"',
      toggledClass: "app-sidebar-mobile-toggled",
      closedClass: "app-sidebar-mobile-closed",
      backdrop: {
        class: "app-sidebar-mobile-backdrop",
      },
    },
    minify: {
      toggleAttr: 'data-toggle="app-sidebar-minify"',
      toggledClass: "app-sidebar-minified",
      cookieName: "app-sidebar-minified",
    },
    floatSubmenu: {
      id: "#app-sidebar-float-submenu",
      dom: "",
      timeout: "",
      class: "app-sidebar-float-submenu",
      container: {
        class: "app-sidebar-float-submenu-container",
      },
      arrow: {
        id: "#app-sidebar-float-submenu-arrow",
        class: "app-sidebar-float-submenu-arrow",
      },
      line: {
        id: "#app-sidebar-float-submenu-line",
        class: "app-sidebar-float-submenu-line",
      },
      overflow: {
        class: "overflow-scroll mh-100vh",
      },
    },
    search: {
      class: "menu-search",
      toggleAttr: 'data-sidebar-search="true"',
      hideClass: "d-none",
      foundClass: "has-text",
    },
    transparent: {
      class: "app-sidebar-transparent",
    },
  },
  scrollBar: {
    attr: 'data-scrollbar="true"',
    skipMobileAttr: "data-skip-mobile",
    heightAttr: "data-height",
    wheelPropagationAttr: "data-wheel-propagation",
  },
  content: {
    id: "#content",
    class: "app-content",
    fullHeight: {
      class: "app-content-full-height",
    },
    fullWidth: {
      class: "app-content-full-width",
    },
  },
  layout: {
    sidebarLight: {
      class: "app-with-light-sidebar",
    },
    sidebarEnd: {
      class: "app-with-end-sidebar",
    },
    sidebarWide: {
      class: "app-with-wide-sidebar",
    },
    sidebarMinified: {
      class: "app-sidebar-minified",
    },
    sidebarTwo: {
      class: "app-with-two-sidebar",
    },
    withoutHeader: {
      class: "app-without-header",
    },
    withoutSidebar: {
      class: "app-without-sidebar",
    },
    topMenu: {
      class: "app-with-top-menu",
    },
    boxedLayout: {
      class: "boxed-layout",
    },
  },
  scrollToTopBtn: {
    showClass: "show",
    heightShow: 200,
    toggleAttr: 'data-toggle="scroll-to-top"',
    scrollSpeed: 500,
  },
  scrollTo: {
    attr: 'data-toggle="scroll-to"',
    target: "data-target",
    linkTarget: "href",
  },
  themePanel: {
    class: "app-theme-panel",
    toggleAttr: 'data-toggle="theme-panel-expand"',
    cookieName: "app-theme-panel-expand",
    activeClass: "active",
    themeListCLass: "app-theme-list",
    themeListItemCLass: "app-theme-list-item",
    themeCoverClass: "app-theme-cover",
    themeCoverItemClass: "app-theme-cover-item",
    theme: {
      toggleAttr: 'data-toggle="theme-selector"',
      classAttr: "data-theme-class",
      cookieName: "app-theme",
      activeClass: "active",
    },
    themeCover: {
      toggleAttr: 'data-toggle="theme-cover-selector"',
      classAttr: "data-theme-cover-class",
      cookieName: "app-theme-cover",
      activeClass: "active",
    },
  },
  dismissClass: {
    toggleAttr: "data-dismiss-class",
    targetAttr: "data-dismiss-target",
  },
  toggleClass: {
    toggleAttr: "data-toggle-class",
    targetAttr: "data-toggle-target",
  },
  font: {
    family: getComputedStyle(document.body).getPropertyValue(
      "--bs-body-font-family"
    ),
    size: getComputedStyle(document.body).getPropertyValue(
      "--bs-body-font-size"
    ),
    weight: getComputedStyle(document.body).getPropertyValue(
      "--bs-body-font-weight"
    ),
  },
  color: {
    theme: getComputedStyle(document.body).getPropertyValue("--bs-theme"),
    blue: getComputedStyle(document.body).getPropertyValue("--bs-blue"),
    green: getComputedStyle(document.body).getPropertyValue("--bs-green"),
    orange: getComputedStyle(document.body).getPropertyValue("--bs-orange"),
    red: getComputedStyle(document.body).getPropertyValue("--bs-red"),
    cyan: getComputedStyle(document.body).getPropertyValue("--bs-cyan"),
    purple: getComputedStyle(document.body).getPropertyValue("--bs-purple"),
    yellow: getComputedStyle(document.body).getPropertyValue("--bs-yellow"),
    indigo: getComputedStyle(document.body).getPropertyValue("--bs-indigo"),
    pink: getComputedStyle(document.body).getPropertyValue("--bs-pink"),
    black: getComputedStyle(document.body).getPropertyValue("--bs-black"),
    white: getComputedStyle(document.body).getPropertyValue("--bs-white"),
    gray: getComputedStyle(document.body).getPropertyValue("--bs-gray"),
    dark: getComputedStyle(document.body).getPropertyValue("--bs-dark"),
    gray100: getComputedStyle(document.body).getPropertyValue("--bs-gray-100"),
    gray200: getComputedStyle(document.body).getPropertyValue("--bs-gray-200"),
    gray300: getComputedStyle(document.body).getPropertyValue("--bs-gray-300"),
    gray400: getComputedStyle(document.body).getPropertyValue("--bs-gray-400"),
    gray500: getComputedStyle(document.body).getPropertyValue("--bs-gray-500"),
    gray600: getComputedStyle(document.body).getPropertyValue("--bs-gray-600"),
    gray700: getComputedStyle(document.body).getPropertyValue("--bs-gray-700"),
    gray800: getComputedStyle(document.body).getPropertyValue("--bs-gray-800"),
    gray900: getComputedStyle(document.body).getPropertyValue("--bs-gray-900"),

    themeRgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-theme-rgb"
    ),
    blueRgb: getComputedStyle(document.body).getPropertyValue("--bs-blue-rgb"),
    greenRgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-green-rgb"
    ),
    orangeRgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-orange-rgb"
    ),
    redRgb: getComputedStyle(document.body).getPropertyValue("--bs-red-rgb"),
    cyanRgb: getComputedStyle(document.body).getPropertyValue("--bs-cyan-rgb"),
    purpleRgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-purple-rgb"
    ),
    yellowRgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-yellow-rgb"
    ),
    indigoRgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-indigo-rgb"
    ),
    pinkRgb: getComputedStyle(document.body).getPropertyValue("--bs-pink-rgb"),
    blackRgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-black-rgb"
    ),
    whiteRgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-white-rgb"
    ),
    grayRgb: getComputedStyle(document.body).getPropertyValue("--bs-gray-rgb"),
    darkRgb: getComputedStyle(document.body).getPropertyValue("--bs-dark-rgb"),
    gray100Rgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-gray-100-rgb"
    ),
    gray200Rgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-gray-200-rgb"
    ),
    gray300Rgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-gray-300-rgb"
    ),
    gray400Rgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-gray-400-rgb"
    ),
    gray500Rgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-gray-500-rgb"
    ),
    gray600Rgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-gray-600-rgb"
    ),
    gray700Rgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-gray-700-rgb"
    ),
    gray800Rgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-gray-800-rgb"
    ),
    gray900Rgb: getComputedStyle(document.body).getPropertyValue(
      "--bs-gray-900-rgb"
    ),
  },
  card: {
    expand: {
      status: false,
      toggleAttr: 'data-toggle="card-expand"',
      toggleTitle: "Expand / Compress",
      class: "card-expand",
    },
  },
  init: {
    attr: "data-init",
  },
};

/* 02. Handle Scrollbar
------------------------------------------------ */
var handleScrollbar = function() {
  "use strict";
  var elms = document.querySelectorAll("[" + app.scrollBar.attr + "]");

  for (var i = 0; i < elms.length; i++) {
    generateScrollbar(elms[i]);
  }
};
var generateScrollbar = function(elm) {
  "use strict";

  if (
    elm.scrollbarInit ||
    (app.isMobile && elm.getAttribute(app.scrollBar.skipMobileAttr))
  ) {
    return;
  }
  var dataHeight = !elm.getAttribute(app.scrollBar.heightAttr)
    ? elm.offsetHeight
    : elm.getAttribute(app.scrollBar.heightAttr);

  elm.style.height = dataHeight;
  elm.scrollbarInit = true;

  if (app.isMobile) {
    elm.style.overflowX = "scroll";
  } else {
    var dataWheelPropagation = elm.getAttribute(
      app.scrollBar.wheelPropagationAttr
    )
      ? elm.getAttribute(app.scrollBar.wheelPropagationAttr)
      : false;

    if (
      elm.closest("." + app.sidebar.class) &&
      elm.closest("." + app.sidebar.class).length !== 0
    ) {
      app.sidebar.scrollBar.dom = new PerfectScrollbar(elm, {
        wheelPropagation: dataWheelPropagation,
      });
    } else {
      new PerfectScrollbar(elm, {
        wheelPropagation: dataWheelPropagation,
      });
    }
  }
  elm.setAttribute(app.init.attr, true);
};

/* 03. Handle Sidebar Menu
------------------------------------------------ */
var handleSidebarMenuToggle = function(menus) {
  menus.map(function(menu) {
    menu.onclick = function(e) {
      e.preventDefault();
      var target = this.nextElementSibling;

      menus.map(function(m) {
        var otherTarget = m.nextElementSibling;
        if (otherTarget !== target) {
          otherTarget.style.display = "none";
          otherTarget
            .closest("." + app.sidebar.menu.itemClass)
            .classList.remove(app.sidebar.menu.expandClass);
        }
      });

      var targetItemElm = target.closest("." + app.sidebar.menu.itemClass);

      if (
        targetItemElm.classList.contains(app.sidebar.menu.expandClass) ||
        (targetItemElm.classList.contains(app.sidebar.menu.activeClass) &&
          !target.style.display)
      ) {
        targetItemElm.classList.remove(app.sidebar.menu.expandClass);
        target.style.display = "none";
      } else {
        targetItemElm.classList.add(app.sidebar.menu.expandClass);
        target.style.display = "block";
      }
    };
  });
};
var handleSidebarMenu = function() {
  "use strict";

  var menuBaseSelector =
    "." +
    app.sidebar.class +
    " ." +
    app.sidebar.menu.class +
    " > ." +
    app.sidebar.menu.itemClass +
    "." +
    app.sidebar.menu.hasSubClass;
  var submenuBaseSelector =
    " > ." +
    app.sidebar.menu.submenu.class +
    " > ." +
    app.sidebar.menu.itemClass +
    "." +
    app.sidebar.menu.hasSubClass;

  // menu
  var menuLinkSelector =
    menuBaseSelector + " > ." + app.sidebar.menu.itemLinkClass;
  var menus = [].slice.call(document.querySelectorAll(menuLinkSelector));
  handleSidebarMenuToggle(menus);

  // submenu lvl 1
  var submenuLvl1Selector = menuBaseSelector + submenuBaseSelector;
  var submenusLvl1 = [].slice.call(
    document.querySelectorAll(
      submenuLvl1Selector + " > ." + app.sidebar.menu.itemLinkClass
    )
  );
  handleSidebarMenuToggle(submenusLvl1);

  // submenu lvl 2
  var submenuLvl2Selector =
    menuBaseSelector + submenuBaseSelector + submenuBaseSelector;
  var submenusLvl2 = [].slice.call(
    document.querySelectorAll(
      submenuLvl2Selector + " > ." + app.sidebar.menu.itemLinkClass
    )
  );
  handleSidebarMenuToggle(submenusLvl2);
};

/* 04. Handle Sidebar Scroll Memory
------------------------------------------------ */
var handleSidebarScrollMemory = function() {
  if (!app.isMobile) {
    try {
      if (
        typeof Storage !== "undefined" &&
        typeof localStorage !== "undefined"
      ) {
        var elm = document.querySelector(
          "." + app.sidebar.class + " [" + app.scrollBar.attr + "]"
        );

        elm.onscroll = function() {
          localStorage.setItem(
            app.sidebar.scrollBar.localStorage,
            this.scrollTop
          );
        };
        var defaultScroll = localStorage.getItem(
          app.sidebar.scrollBar.localStorage
        );
        if (defaultScroll) {
          document.querySelector(
            "." + app.sidebar.class + " [" + app.scrollBar.attr + "]"
          ).scrollTop = defaultScroll;
        }
      }
    } catch (error) {
      console.log(error);
    }
  }
};

/* 05. Handle Card Action
------------------------------------------------ */
var handleCardAction = function() {
  "use strict";

  if (app.card.expand.status) {
    return false;
  }
  app.card.expand.status = true;

  // expand
  var expandTogglerList = [].slice.call(
    document.querySelectorAll("[" + app.card.expand.toggleAttr + "]")
  );
  var expandTogglerTooltipList = expandTogglerList.map(function(
    expandTogglerEl
  ) {
    expandTogglerEl.onclick = function(e) {
      e.preventDefault();

      var target = this.closest(".card");
      var targetClass = app.card.expand.class;
      var targetTop = 40;

      if (
        document.body.classList.contains(targetClass) &&
        target.classList.contains(targetClass)
      ) {
        target.removeAttribute("style");
        target.classList.remove(targetClass);
        document.body.classList.remove(targetClass);
      } else {
        document.body.classList.add(targetClass);
        target.classList.add(targetClass);
      }

      window.dispatchEvent(new Event("resize"));
    };

    return new bootstrap.Tooltip(expandTogglerEl, {
      title: app.card.expand.toggleTitle,
      placement: "bottom",
      trigger: "hover",
      container: "body",
    });
  });
};

/* 06. Handle Tooltip & Popover Activation
------------------------------------------------ */
var handelTooltipPopoverActivation = function() {
  "use strict";

  var tooltipTriggerList = [].slice.call(
    document.querySelectorAll("[" + app.bootstrap.tooltip.attr + "]")
  );
  var tooltipList = tooltipTriggerList.map(function(tooltipTriggerEl) {
    return new bootstrap.Tooltip(tooltipTriggerEl);
  });

  var popoverTriggerList = [].slice.call(
    document.querySelectorAll("[" + app.bootstrap.popover.attr + "]")
  );
  var popoverList = popoverTriggerList.map(function(popoverTriggerEl) {
    return new bootstrap.Popover(popoverTriggerEl);
  });
};

/* 07. Handle Scroll to Top Button
------------------------------------------------ */
var handleScrollToTopButton = function() {
  "use strict";

  var elmTriggerList = [].slice.call(
    document.querySelectorAll("[" + app.scrollToTopBtn.toggleAttr + "]")
  );

  document.onscroll = function() {
    var doc = document.documentElement;
    var totalScroll =
      (window.pageYOffset || doc.scrollTop) - (doc.clientTop || 0);
    var elmList = elmTriggerList.map(function(elm) {
      if (totalScroll >= app.scrollToTopBtn.heightShow) {
        if (!elm.classList.contains(app.scrollToTopBtn.showClass)) {
          elm.classList.add(app.scrollToTopBtn.showClass);
        }
      } else {
        elm.classList.remove(app.scrollToTopBtn.showClass);
      }
    });

    var elm = document.querySelectorAll(app.id)[0];

    if (totalScroll > 0) {
      elm.classList.add(app.header.hasScrollClass);
    } else {
      elm.classList.remove(app.header.hasScrollClass);
    }
  };

  var elmList = elmTriggerList.map(function(elm) {
    elm.onclick = function(e) {
      e.preventDefault();

      window.scrollTo({ top: 0, behavior: "smooth" });
    };
  });
};

/* 08. Handle hexToRgba
------------------------------------------------ */
var hexToRgba = function(hex, transparent = 1) {
  var c;
  if (/^#([A-Fa-f0-9]{3}){1,2}$/.test(hex)) {
    c = hex.substring(1).split("");
    if (c.length == 3) {
      c = [c[0], c[0], c[1], c[1], c[2], c[2]];
    }
    c = "0x" + c.join("");
    return (
      "rgba(" +
      [(c >> 16) & 255, (c >> 8) & 255, c & 255].join(",") +
      "," +
      transparent +
      ")"
    );
  }
  throw new Error("Bad Hex");
};

/* 09. Handle Scroll To
------------------------------------------------ */
var handleScrollTo = function() {
  var elmTriggerList = [].slice.call(
    document.querySelectorAll("[" + app.scrollTo.attr + "]")
  );
  var elmList = elmTriggerList.map(function(elm) {
    elm.onclick = function(e) {
      e.preventDefault();

      var targetAttr = elm.getAttribute(app.scrollTo.target)
        ? this.getAttribute(app.scrollTo.target)
        : this.getAttribute(app.scrollTo.linkTarget);
      var targetElm = document.querySelectorAll(targetAttr)[0];
      var targetHeader = document.querySelectorAll(app.header.id)[0];
      var targetHeight = targetHeader.offsetHeight;
      if (targetElm) {
        var targetTop = targetElm.offsetTop - targetHeight - 24;
        window.scrollTo({ top: targetTop, behavior: "smooth" });
      }
    };
  });
};

/* 10. Handle Toggle Class
------------------------------------------------ */
var handleToggleClass = function() {
  var elmList = [].slice.call(
    document.querySelectorAll("[" + app.toggleClass.toggleAttr + "]")
  );

  elmList.map(function(elm) {
    elm.onclick = function(e) {
      e.preventDefault();

      var targetToggleClass = this.getAttribute(app.toggleClass.toggleAttr);
      var targetDismissClass = this.getAttribute(app.dismissClass.toggleAttr);
      var targetToggleElm = document.querySelector(
        this.getAttribute(app.toggleClass.targetAttr)
      );

      if (!targetDismissClass) {
        if (targetToggleElm.classList.contains(targetToggleClass)) {
          targetToggleElm.classList.remove(targetToggleClass);
        } else {
          targetToggleElm.classList.add(targetToggleClass);
        }
      } else {
        if (
          !targetToggleElm.classList.contains(targetToggleClass) &&
          !targetToggleElm.classList.contains(targetDismissClass)
        ) {
          if (targetToggleElm.classList.contains(targetToggleClass)) {
            targetToggleElm.classList.remove(targetToggleClass);
          } else {
            targetToggleElm.classList.add(targetToggleClass);
          }
        } else {
          if (targetToggleElm.classList.contains(targetToggleClass)) {
            targetToggleElm.classList.remove(targetToggleClass);
          } else {
            targetToggleElm.classList.add(targetToggleClass);
          }
          if (targetToggleElm.classList.contains(targetDismissClass)) {
            targetToggleElm.classList.remove(targetDismissClass);
          } else {
            targetToggleElm.classList.add(targetDismissClass);
          }
        }
      }
    };
  });
};

/* 11. Handle Theme Panel
------------------------------------------------ */
var handleThemePanel = function() {
  "use strict";

  // 12.1 Theme Panel - Toggle / Dismiss
  var elmList = [].slice.call(
    document.querySelectorAll("[" + app.themePanel.toggleAttr + "]")
  );

  elmList.map(function(elm) {
    elm.onclick = function(e) {
      e.preventDefault();

      var targetContainer = document.querySelector("." + app.themePanel.class);
      var targetExpand = false;

      if (targetContainer.classList.contains(app.themePanel.activeClass)) {
        targetContainer.classList.remove(app.themePanel.activeClass);
      } else {
        targetContainer.classList.add(app.themePanel.activeClass);
        targetExpand = true;
      }
      if (Cookies) {
        Cookies.set(app.themePanel.cookieName, targetExpand);
      }
    };
  });

  // 12.2 Theme Panel - Page Load Cookies
  // if (Cookies) {
  //   var themePanelExpand = Cookies.get(app.themePanel.cookieName);

  //   if (themePanelExpand == "true" || typeof themePanelExpand == "undefined") {
  //     var elm = document.querySelector("[" + app.themePanel.toggleAttr + "]");
  //     elm.click();
  //   }
  // }

  // 12.3 Theme Panel - Theme Selector
  var elmList = [].slice.call(
    document.querySelectorAll(
      "." + app.themePanel.class + " [" + app.themePanel.theme.toggleAttr + "]"
    )
  );
  elmList.map(function(elm) {
    elm.onclick = function() {
      for (var x = 0; x < document.body.classList.length; x++) {
        var targetClass = document.body.classList[x];
        if (targetClass.search("theme-") > -1) {
          document.body.classList.remove(targetClass);
        }
      }

      var targetTheme = this.getAttribute(app.themePanel.theme.classAttr);
      var targetThemeList = [].slice.call(
        document.querySelectorAll(
          "." +
            app.themePanel.class +
            " [" +
            app.themePanel.theme.toggleAttr +
            "]"
        )
      );

      if (targetTheme) {
        document.body.classList.add(targetTheme);
      }
      targetThemeList.map(function(targetElm) {
        if (
          targetElm.getAttribute(app.themePanel.theme.classAttr) != targetTheme
        ) {
          targetElm
            .closest("." + app.themePanel.themeListItemCLass)
            .classList.remove(app.themePanel.theme.activeClass);
        }
      });

      this.closest("." + app.themePanel.themeListItemCLass).classList.add(
        app.themePanel.theme.activeClass
      );

      if (Cookies) {
        Cookies.set(app.themePanel.theme.cookieName, targetTheme);
        app.color.theme = getComputedStyle(document.body).getPropertyValue(
          "--bs-theme"
        );
        app.color.themeRgb = getComputedStyle(document.body).getPropertyValue(
          "--bs-theme-rgb"
        );

        document.dispatchEvent(new Event("theme-reload"));
      }
    };
  });

  if (Cookies) {
    if (Cookies.get(app.themePanel.theme.cookieName)) {
      var targetElm = document.querySelector(
        "." +
          app.themePanel.class +
          " [" +
          app.themePanel.theme.toggleAttr +
          "]" +
          "[" +
          app.themePanel.theme.classAttr +
          '="' +
          Cookies.get(app.themePanel.theme.cookieName) +
          '"]'
      );
      targetElm.click();

      app.color.theme = getComputedStyle(document.body).getPropertyValue(
        "--bs-theme"
      );
      app.color.themeRgb = getComputedStyle(document.body).getPropertyValue(
        "--bs-theme-rgb"
      );

      document.dispatchEvent(new Event("theme-reload"));
    }
  }

  // 12.4 Theme Panel - Background Selector
  var elmList = [].slice.call(
    document.querySelectorAll(
      "." +
        app.themePanel.class +
        " [" +
        app.themePanel.themeCover.toggleAttr +
        "]"
    )
  );
  elmList.map(function(elm) {
    elm.onclick = function(e) {
      e.preventDefault();

      var htmlElm = document.querySelector("html");
      var targetTheme = this.getAttribute(app.themePanel.themeCover.classAttr);
      for (var x = 0; x < document.documentElement.classList.length; x++) {
        var targetClass = document.documentElement.classList[x];
        if (targetClass.search("bg-cover-") > -1) {
          htmlElm.classList.remove(targetClass);
        }
      }

      if (targetTheme) {
        htmlElm.classList.add(targetTheme);
      }

      var targetCoverList = [].slice.call(
        document.querySelectorAll(
          "." +
            app.themePanel.class +
            " [" +
            app.themePanel.themeCover.toggleAttr +
            "]"
        )
      );
      targetCoverList.map(function(targetElm) {
        if (
          targetElm.getAttribute(app.themePanel.themeCover.toggleAttr) !=
          targetTheme
        ) {
          targetElm
            .closest("." + app.themePanel.themeCoverItemClass)
            .classList.remove(app.themePanel.themeCover.activeClass);
        }
      });

      this.closest("." + app.themePanel.themeCoverItemClass).classList.add(
        app.themePanel.themeCover.activeClass
      );
      if (Cookies) {
        Cookies.set(app.themePanel.themeCover.cookieName, targetTheme);
      }
    };
  });

  if (Cookies) {
    if (Cookies.get(app.themePanel.themeCover.cookieName)) {
      var targetElm = document.querySelector(
        "." +
          app.themePanel.class +
          " [" +
          app.themePanel.themeCover.toggleAttr +
          "]" +
          "[" +
          app.themePanel.themeCover.classAttr +
          '="' +
          Cookies.get(app.themePanel.themeCover.cookieName) +
          '"]'
      );
      if (targetElm) {
        targetElm.click();
      }
    }
  }
};

/* 12. Application Controller
------------------------------------------------ */
var App = (function() {
  "use strict";

  return {
    //main function
    init: function() {
      this.initComponent();
      this.initSidebar();
    },
    initSidebar: function() {
      handleSidebarMenu();
      handleSidebarScrollMemory();
    },
    initComponent: function() {
      handleScrollbar();
      handleScrollToTopButton();
      handleScrollTo();
      handleCardAction();
      handelTooltipPopoverActivation();
      handleToggleClass();
      handleThemePanel();
    },
    scrollTop: function() {
      window.scrollTo({ top: 0, behavior: "smooth" });
    },
  };
})();

/* 13. Initialise
------------------------------------------------ */
document.addEventListener("DOMContentLoaded", function() {
  App.init();
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiLypcclxuVGVtcGxhdGUgTmFtZTogSFVEIC0gUmVzcG9uc2l2ZSBCb290c3RyYXAgNSBBZG1pbiBUZW1wbGF0ZVxyXG5WZXJzaW9uOiAxLjQuMFxyXG5BdXRob3I6IFNlYW4gTmd1XHJcbldlYnNpdGU6IGh0dHA6Ly93d3cuc2VhbnRoZW1lLmNvbS9odWQvXHJcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cdFx0QVBQUyBDT05URU5UIFRBQkxFXHJcblx0LS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLVxyXG5cclxuXHQ8IS0tID09PT09PT09IEdMT0JBTCBTQ1JJUFQgU0VUVElORyA9PT09PT09PSAtLT5cclxuICAwMS4gR2xvYmFsIFZhcmlhYmxlXHJcbiAgMDIuIEhhbmRsZSBTY3JvbGxiYXJcclxuICAwMy4gSGFuZGxlIFNpZGViYXIgTWVudVxyXG4gIDA0LiBIYW5kbGUgU2lkZWJhciBTY3JvbGwgTWVtb3J5XHJcbiAgMDUuIEhhbmRsZSBDYXJkIEFjdGlvblxyXG4gIDA2LiBIYW5kbGUgVG9vbHRpcCAmIFBvcG92ZXIgQWN0aXZhdGlvblxyXG4gIDA3LiBIYW5kbGUgU2Nyb2xsIHRvIFRvcCBCdXR0b25cclxuICAwOC4gSGFuZGxlIGhleFRvUmdiYVxyXG4gIDA5LiBIYW5kbGUgU2Nyb2xsIFRvXHJcbiAgMTAuIEhhbmRsZSBUb2dnbGUgQ2xhc3NcclxuICAxMS4gSGFuZGxlIFRoZW1lIFBhbmVsXHJcbiAgMTIuIEFwcGxpY2F0aW9uIENvbnRyb2xsZXJcclxuICAxMy4gSW5pdGlhbGlzZVxyXG5cdFxyXG5cdDwhLS0gPT09PT09PT0gQVBQTElDQVRJT04gU0VUVElORyA9PT09PT09PSAtLT5cclxuXHRBcHBsaWNhdGlvbiBDb250cm9sbGVyXHJcbiovXHJcblxyXG4vKiAwMS4gR2xvYmFsIFZhcmlhYmxlXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgYXBwID0ge1xyXG4gIGlkOiBcIiNhcHBcIixcclxuICBpc01vYmlsZTpcclxuICAgIC9BbmRyb2lkfHdlYk9TfGlQaG9uZXxpUGFkfGlQb2R8QmxhY2tCZXJyeXxJRU1vYmlsZXxPcGVyYSBNaW5pL2kudGVzdChcclxuICAgICAgbmF2aWdhdG9yLnVzZXJBZ2VudFxyXG4gICAgKSB8fCB3aW5kb3cuaW5uZXJXaWR0aCA8IDk5MixcclxuICBib290c3RyYXA6IHtcclxuICAgIHRvb2x0aXA6IHtcclxuICAgICAgYXR0cjogJ2RhdGEtYnMtdG9nZ2xlPVwidG9vbHRpcFwiJyxcclxuICAgIH0sXHJcbiAgICBwb3BvdmVyOiB7XHJcbiAgICAgIGF0dHI6ICdkYXRhLWJzLXRvZ2dsZT1cInBvcG92ZXJcIicsXHJcbiAgICB9LFxyXG4gICAgbW9kYWw6IHtcclxuICAgICAgYXR0cjogJ2RhdGEtYnMtdG9nZ2xlPVwibW9kYWxcIicsXHJcbiAgICAgIGRpc21pc3NBdHRyOiAnZGF0YS1icy1kaXNtaXNzPVwibW9kYWxcIicsXHJcbiAgICAgIGV2ZW50OiB7XHJcbiAgICAgICAgaGlkZGVuOiBcImhpZGRlbi5icy5tb2RhbFwiLFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIG5hdjoge1xyXG4gICAgICBjbGFzczogXCJuYXZcIixcclxuICAgICAgdGFiczoge1xyXG4gICAgICAgIGNsYXNzOiBcIm5hdi10YWJzXCIsXHJcbiAgICAgICAgYWN0aXZlQ2xhc3M6IFwiYWN0aXZlXCIsXHJcbiAgICAgICAgaXRlbUNsYXNzOiBcIm5hdi1pdGVtXCIsXHJcbiAgICAgICAgaXRlbUxpbmtDbGFzczogXCJuYXYtbGlua1wiLFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICB9LFxyXG4gIGhlYWRlcjoge1xyXG4gICAgaWQ6IFwiI2hlYWRlclwiLFxyXG4gICAgY2xhc3M6IFwiYXBwLWhlYWRlclwiLFxyXG4gICAgaGFzU2Nyb2xsQ2xhc3M6IFwiaGFzLXNjcm9sbFwiLFxyXG4gIH0sXHJcbiAgc2lkZWJhcjoge1xyXG4gICAgaWQ6IFwiI3NpZGViYXJcIixcclxuICAgIGNsYXNzOiBcImFwcC1zaWRlYmFyXCIsXHJcbiAgICBzY3JvbGxCYXI6IHtcclxuICAgICAgbG9jYWxTdG9yYWdlOiBcImFwcFNpZGViYXJTY3JvbGxQb3NpdGlvblwiLFxyXG4gICAgICBkb206IFwiXCIsXHJcbiAgICB9LFxyXG4gICAgbWVudToge1xyXG4gICAgICBjbGFzczogXCJtZW51XCIsXHJcbiAgICAgIGluaXRBdHRyOiBcImRhdGEtaW5pdFwiLFxyXG4gICAgICBhbmltYXRpb25UaW1lOiAwLFxyXG4gICAgICBpdGVtQ2xhc3M6IFwibWVudS1pdGVtXCIsXHJcbiAgICAgIGl0ZW1MaW5rQ2xhc3M6IFwibWVudS1saW5rXCIsXHJcbiAgICAgIGhhc1N1YkNsYXNzOiBcImhhcy1zdWJcIixcclxuICAgICAgYWN0aXZlQ2xhc3M6IFwiYWN0aXZlXCIsXHJcbiAgICAgIGV4cGFuZGluZ0NsYXNzOiBcImV4cGFuZGluZ1wiLFxyXG4gICAgICBleHBhbmRDbGFzczogXCJleHBhbmRcIixcclxuICAgICAgc3VibWVudToge1xyXG4gICAgICAgIGNsYXNzOiBcIm1lbnUtc3VibWVudVwiLFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIG1vYmlsZToge1xyXG4gICAgICB0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJhcHAtc2lkZWJhci1tb2JpbGVcIicsXHJcbiAgICAgIGRpc21pc3NBdHRyOiAnZGF0YS1kaXNtaXNzPVwiYXBwLXNpZGViYXItbW9iaWxlXCInLFxyXG4gICAgICB0b2dnbGVkQ2xhc3M6IFwiYXBwLXNpZGViYXItbW9iaWxlLXRvZ2dsZWRcIixcclxuICAgICAgY2xvc2VkQ2xhc3M6IFwiYXBwLXNpZGViYXItbW9iaWxlLWNsb3NlZFwiLFxyXG4gICAgICBiYWNrZHJvcDoge1xyXG4gICAgICAgIGNsYXNzOiBcImFwcC1zaWRlYmFyLW1vYmlsZS1iYWNrZHJvcFwiLFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIG1pbmlmeToge1xyXG4gICAgICB0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJhcHAtc2lkZWJhci1taW5pZnlcIicsXHJcbiAgICAgIHRvZ2dsZWRDbGFzczogXCJhcHAtc2lkZWJhci1taW5pZmllZFwiLFxyXG4gICAgICBjb29raWVOYW1lOiBcImFwcC1zaWRlYmFyLW1pbmlmaWVkXCIsXHJcbiAgICB9LFxyXG4gICAgZmxvYXRTdWJtZW51OiB7XHJcbiAgICAgIGlkOiBcIiNhcHAtc2lkZWJhci1mbG9hdC1zdWJtZW51XCIsXHJcbiAgICAgIGRvbTogXCJcIixcclxuICAgICAgdGltZW91dDogXCJcIixcclxuICAgICAgY2xhc3M6IFwiYXBwLXNpZGViYXItZmxvYXQtc3VibWVudVwiLFxyXG4gICAgICBjb250YWluZXI6IHtcclxuICAgICAgICBjbGFzczogXCJhcHAtc2lkZWJhci1mbG9hdC1zdWJtZW51LWNvbnRhaW5lclwiLFxyXG4gICAgICB9LFxyXG4gICAgICBhcnJvdzoge1xyXG4gICAgICAgIGlkOiBcIiNhcHAtc2lkZWJhci1mbG9hdC1zdWJtZW51LWFycm93XCIsXHJcbiAgICAgICAgY2xhc3M6IFwiYXBwLXNpZGViYXItZmxvYXQtc3VibWVudS1hcnJvd1wiLFxyXG4gICAgICB9LFxyXG4gICAgICBsaW5lOiB7XHJcbiAgICAgICAgaWQ6IFwiI2FwcC1zaWRlYmFyLWZsb2F0LXN1Ym1lbnUtbGluZVwiLFxyXG4gICAgICAgIGNsYXNzOiBcImFwcC1zaWRlYmFyLWZsb2F0LXN1Ym1lbnUtbGluZVwiLFxyXG4gICAgICB9LFxyXG4gICAgICBvdmVyZmxvdzoge1xyXG4gICAgICAgIGNsYXNzOiBcIm92ZXJmbG93LXNjcm9sbCBtaC0xMDB2aFwiLFxyXG4gICAgICB9LFxyXG4gICAgfSxcclxuICAgIHNlYXJjaDoge1xyXG4gICAgICBjbGFzczogXCJtZW51LXNlYXJjaFwiLFxyXG4gICAgICB0b2dnbGVBdHRyOiAnZGF0YS1zaWRlYmFyLXNlYXJjaD1cInRydWVcIicsXHJcbiAgICAgIGhpZGVDbGFzczogXCJkLW5vbmVcIixcclxuICAgICAgZm91bmRDbGFzczogXCJoYXMtdGV4dFwiLFxyXG4gICAgfSxcclxuICAgIHRyYW5zcGFyZW50OiB7XHJcbiAgICAgIGNsYXNzOiBcImFwcC1zaWRlYmFyLXRyYW5zcGFyZW50XCIsXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgc2Nyb2xsQmFyOiB7XHJcbiAgICBhdHRyOiAnZGF0YS1zY3JvbGxiYXI9XCJ0cnVlXCInLFxyXG4gICAgc2tpcE1vYmlsZUF0dHI6IFwiZGF0YS1za2lwLW1vYmlsZVwiLFxyXG4gICAgaGVpZ2h0QXR0cjogXCJkYXRhLWhlaWdodFwiLFxyXG4gICAgd2hlZWxQcm9wYWdhdGlvbkF0dHI6IFwiZGF0YS13aGVlbC1wcm9wYWdhdGlvblwiLFxyXG4gIH0sXHJcbiAgY29udGVudDoge1xyXG4gICAgaWQ6IFwiI2NvbnRlbnRcIixcclxuICAgIGNsYXNzOiBcImFwcC1jb250ZW50XCIsXHJcbiAgICBmdWxsSGVpZ2h0OiB7XHJcbiAgICAgIGNsYXNzOiBcImFwcC1jb250ZW50LWZ1bGwtaGVpZ2h0XCIsXHJcbiAgICB9LFxyXG4gICAgZnVsbFdpZHRoOiB7XHJcbiAgICAgIGNsYXNzOiBcImFwcC1jb250ZW50LWZ1bGwtd2lkdGhcIixcclxuICAgIH0sXHJcbiAgfSxcclxuICBsYXlvdXQ6IHtcclxuICAgIHNpZGViYXJMaWdodDoge1xyXG4gICAgICBjbGFzczogXCJhcHAtd2l0aC1saWdodC1zaWRlYmFyXCIsXHJcbiAgICB9LFxyXG4gICAgc2lkZWJhckVuZDoge1xyXG4gICAgICBjbGFzczogXCJhcHAtd2l0aC1lbmQtc2lkZWJhclwiLFxyXG4gICAgfSxcclxuICAgIHNpZGViYXJXaWRlOiB7XHJcbiAgICAgIGNsYXNzOiBcImFwcC13aXRoLXdpZGUtc2lkZWJhclwiLFxyXG4gICAgfSxcclxuICAgIHNpZGViYXJNaW5pZmllZDoge1xyXG4gICAgICBjbGFzczogXCJhcHAtc2lkZWJhci1taW5pZmllZFwiLFxyXG4gICAgfSxcclxuICAgIHNpZGViYXJUd286IHtcclxuICAgICAgY2xhc3M6IFwiYXBwLXdpdGgtdHdvLXNpZGViYXJcIixcclxuICAgIH0sXHJcbiAgICB3aXRob3V0SGVhZGVyOiB7XHJcbiAgICAgIGNsYXNzOiBcImFwcC13aXRob3V0LWhlYWRlclwiLFxyXG4gICAgfSxcclxuICAgIHdpdGhvdXRTaWRlYmFyOiB7XHJcbiAgICAgIGNsYXNzOiBcImFwcC13aXRob3V0LXNpZGViYXJcIixcclxuICAgIH0sXHJcbiAgICB0b3BNZW51OiB7XHJcbiAgICAgIGNsYXNzOiBcImFwcC13aXRoLXRvcC1tZW51XCIsXHJcbiAgICB9LFxyXG4gICAgYm94ZWRMYXlvdXQ6IHtcclxuICAgICAgY2xhc3M6IFwiYm94ZWQtbGF5b3V0XCIsXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgc2Nyb2xsVG9Ub3BCdG46IHtcclxuICAgIHNob3dDbGFzczogXCJzaG93XCIsXHJcbiAgICBoZWlnaHRTaG93OiAyMDAsXHJcbiAgICB0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJzY3JvbGwtdG8tdG9wXCInLFxyXG4gICAgc2Nyb2xsU3BlZWQ6IDUwMCxcclxuICB9LFxyXG4gIHNjcm9sbFRvOiB7XHJcbiAgICBhdHRyOiAnZGF0YS10b2dnbGU9XCJzY3JvbGwtdG9cIicsXHJcbiAgICB0YXJnZXQ6IFwiZGF0YS10YXJnZXRcIixcclxuICAgIGxpbmtUYXJnZXQ6IFwiaHJlZlwiLFxyXG4gIH0sXHJcbiAgdGhlbWVQYW5lbDoge1xyXG4gICAgY2xhc3M6IFwiYXBwLXRoZW1lLXBhbmVsXCIsXHJcbiAgICB0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJ0aGVtZS1wYW5lbC1leHBhbmRcIicsXHJcbiAgICBjb29raWVOYW1lOiBcImFwcC10aGVtZS1wYW5lbC1leHBhbmRcIixcclxuICAgIGFjdGl2ZUNsYXNzOiBcImFjdGl2ZVwiLFxyXG4gICAgdGhlbWVMaXN0Q0xhc3M6IFwiYXBwLXRoZW1lLWxpc3RcIixcclxuICAgIHRoZW1lTGlzdEl0ZW1DTGFzczogXCJhcHAtdGhlbWUtbGlzdC1pdGVtXCIsXHJcbiAgICB0aGVtZUNvdmVyQ2xhc3M6IFwiYXBwLXRoZW1lLWNvdmVyXCIsXHJcbiAgICB0aGVtZUNvdmVySXRlbUNsYXNzOiBcImFwcC10aGVtZS1jb3Zlci1pdGVtXCIsXHJcbiAgICB0aGVtZToge1xyXG4gICAgICB0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJ0aGVtZS1zZWxlY3RvclwiJyxcclxuICAgICAgY2xhc3NBdHRyOiBcImRhdGEtdGhlbWUtY2xhc3NcIixcclxuICAgICAgY29va2llTmFtZTogXCJhcHAtdGhlbWVcIixcclxuICAgICAgYWN0aXZlQ2xhc3M6IFwiYWN0aXZlXCIsXHJcbiAgICB9LFxyXG4gICAgdGhlbWVDb3Zlcjoge1xyXG4gICAgICB0b2dnbGVBdHRyOiAnZGF0YS10b2dnbGU9XCJ0aGVtZS1jb3Zlci1zZWxlY3RvclwiJyxcclxuICAgICAgY2xhc3NBdHRyOiBcImRhdGEtdGhlbWUtY292ZXItY2xhc3NcIixcclxuICAgICAgY29va2llTmFtZTogXCJhcHAtdGhlbWUtY292ZXJcIixcclxuICAgICAgYWN0aXZlQ2xhc3M6IFwiYWN0aXZlXCIsXHJcbiAgICB9LFxyXG4gIH0sXHJcbiAgZGlzbWlzc0NsYXNzOiB7XHJcbiAgICB0b2dnbGVBdHRyOiBcImRhdGEtZGlzbWlzcy1jbGFzc1wiLFxyXG4gICAgdGFyZ2V0QXR0cjogXCJkYXRhLWRpc21pc3MtdGFyZ2V0XCIsXHJcbiAgfSxcclxuICB0b2dnbGVDbGFzczoge1xyXG4gICAgdG9nZ2xlQXR0cjogXCJkYXRhLXRvZ2dsZS1jbGFzc1wiLFxyXG4gICAgdGFyZ2V0QXR0cjogXCJkYXRhLXRvZ2dsZS10YXJnZXRcIixcclxuICB9LFxyXG4gIGZvbnQ6IHtcclxuICAgIGZhbWlseTogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFxyXG4gICAgICBcIi0tYnMtYm9keS1mb250LWZhbWlseVwiXHJcbiAgICApLFxyXG4gICAgc2l6ZTogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFxyXG4gICAgICBcIi0tYnMtYm9keS1mb250LXNpemVcIlxyXG4gICAgKSxcclxuICAgIHdlaWdodDogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFxyXG4gICAgICBcIi0tYnMtYm9keS1mb250LXdlaWdodFwiXHJcbiAgICApLFxyXG4gIH0sXHJcbiAgY29sb3I6IHtcclxuICAgIHRoZW1lOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLXRoZW1lXCIpLFxyXG4gICAgYmx1ZTogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1icy1ibHVlXCIpLFxyXG4gICAgZ3JlZW46IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcIi0tYnMtZ3JlZW5cIiksXHJcbiAgICBvcmFuZ2U6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcIi0tYnMtb3JhbmdlXCIpLFxyXG4gICAgcmVkOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLXJlZFwiKSxcclxuICAgIGN5YW46IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcIi0tYnMtY3lhblwiKSxcclxuICAgIHB1cnBsZTogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1icy1wdXJwbGVcIiksXHJcbiAgICB5ZWxsb3c6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcIi0tYnMteWVsbG93XCIpLFxyXG4gICAgaW5kaWdvOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLWluZGlnb1wiKSxcclxuICAgIHBpbms6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcIi0tYnMtcGlua1wiKSxcclxuICAgIGJsYWNrOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLWJsYWNrXCIpLFxyXG4gICAgd2hpdGU6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcIi0tYnMtd2hpdGVcIiksXHJcbiAgICBncmF5OiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLWdyYXlcIiksXHJcbiAgICBkYXJrOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLWRhcmtcIiksXHJcbiAgICBncmF5MTAwOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLWdyYXktMTAwXCIpLFxyXG4gICAgZ3JheTIwMDogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1icy1ncmF5LTIwMFwiKSxcclxuICAgIGdyYXkzMDA6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcIi0tYnMtZ3JheS0zMDBcIiksXHJcbiAgICBncmF5NDAwOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLWdyYXktNDAwXCIpLFxyXG4gICAgZ3JheTUwMDogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1icy1ncmF5LTUwMFwiKSxcclxuICAgIGdyYXk2MDA6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcIi0tYnMtZ3JheS02MDBcIiksXHJcbiAgICBncmF5NzAwOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLWdyYXktNzAwXCIpLFxyXG4gICAgZ3JheTgwMDogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1icy1ncmF5LTgwMFwiKSxcclxuICAgIGdyYXk5MDA6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcIi0tYnMtZ3JheS05MDBcIiksXHJcblxyXG4gICAgdGhlbWVSZ2I6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcclxuICAgICAgXCItLWJzLXRoZW1lLXJnYlwiXHJcbiAgICApLFxyXG4gICAgYmx1ZVJnYjogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1icy1ibHVlLXJnYlwiKSxcclxuICAgIGdyZWVuUmdiOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXHJcbiAgICAgIFwiLS1icy1ncmVlbi1yZ2JcIlxyXG4gICAgKSxcclxuICAgIG9yYW5nZVJnYjogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFxyXG4gICAgICBcIi0tYnMtb3JhbmdlLXJnYlwiXHJcbiAgICApLFxyXG4gICAgcmVkUmdiOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLXJlZC1yZ2JcIiksXHJcbiAgICBjeWFuUmdiOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLWN5YW4tcmdiXCIpLFxyXG4gICAgcHVycGxlUmdiOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXHJcbiAgICAgIFwiLS1icy1wdXJwbGUtcmdiXCJcclxuICAgICksXHJcbiAgICB5ZWxsb3dSZ2I6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcclxuICAgICAgXCItLWJzLXllbGxvdy1yZ2JcIlxyXG4gICAgKSxcclxuICAgIGluZGlnb1JnYjogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFxyXG4gICAgICBcIi0tYnMtaW5kaWdvLXJnYlwiXHJcbiAgICApLFxyXG4gICAgcGlua1JnYjogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFwiLS1icy1waW5rLXJnYlwiKSxcclxuICAgIGJsYWNrUmdiOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXHJcbiAgICAgIFwiLS1icy1ibGFjay1yZ2JcIlxyXG4gICAgKSxcclxuICAgIHdoaXRlUmdiOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXHJcbiAgICAgIFwiLS1icy13aGl0ZS1yZ2JcIlxyXG4gICAgKSxcclxuICAgIGdyYXlSZ2I6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcIi0tYnMtZ3JheS1yZ2JcIiksXHJcbiAgICBkYXJrUmdiOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXCItLWJzLWRhcmstcmdiXCIpLFxyXG4gICAgZ3JheTEwMFJnYjogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFxyXG4gICAgICBcIi0tYnMtZ3JheS0xMDAtcmdiXCJcclxuICAgICksXHJcbiAgICBncmF5MjAwUmdiOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXHJcbiAgICAgIFwiLS1icy1ncmF5LTIwMC1yZ2JcIlxyXG4gICAgKSxcclxuICAgIGdyYXkzMDBSZ2I6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcclxuICAgICAgXCItLWJzLWdyYXktMzAwLXJnYlwiXHJcbiAgICApLFxyXG4gICAgZ3JheTQwMFJnYjogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFxyXG4gICAgICBcIi0tYnMtZ3JheS00MDAtcmdiXCJcclxuICAgICksXHJcbiAgICBncmF5NTAwUmdiOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXHJcbiAgICAgIFwiLS1icy1ncmF5LTUwMC1yZ2JcIlxyXG4gICAgKSxcclxuICAgIGdyYXk2MDBSZ2I6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcclxuICAgICAgXCItLWJzLWdyYXktNjAwLXJnYlwiXHJcbiAgICApLFxyXG4gICAgZ3JheTcwMFJnYjogZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFxyXG4gICAgICBcIi0tYnMtZ3JheS03MDAtcmdiXCJcclxuICAgICksXHJcbiAgICBncmF5ODAwUmdiOiBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXHJcbiAgICAgIFwiLS1icy1ncmF5LTgwMC1yZ2JcIlxyXG4gICAgKSxcclxuICAgIGdyYXk5MDBSZ2I6IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcclxuICAgICAgXCItLWJzLWdyYXktOTAwLXJnYlwiXHJcbiAgICApLFxyXG4gIH0sXHJcbiAgY2FyZDoge1xyXG4gICAgZXhwYW5kOiB7XHJcbiAgICAgIHN0YXR1czogZmFsc2UsXHJcbiAgICAgIHRvZ2dsZUF0dHI6ICdkYXRhLXRvZ2dsZT1cImNhcmQtZXhwYW5kXCInLFxyXG4gICAgICB0b2dnbGVUaXRsZTogXCJFeHBhbmQgLyBDb21wcmVzc1wiLFxyXG4gICAgICBjbGFzczogXCJjYXJkLWV4cGFuZFwiLFxyXG4gICAgfSxcclxuICB9LFxyXG4gIGluaXQ6IHtcclxuICAgIGF0dHI6IFwiZGF0YS1pbml0XCIsXHJcbiAgfSxcclxufTtcclxuXHJcbi8qIDAyLiBIYW5kbGUgU2Nyb2xsYmFyXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgaGFuZGxlU2Nyb2xsYmFyID0gZnVuY3Rpb24oKSB7XHJcbiAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgdmFyIGVsbXMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW1wiICsgYXBwLnNjcm9sbEJhci5hdHRyICsgXCJdXCIpO1xyXG5cclxuICBmb3IgKHZhciBpID0gMDsgaSA8IGVsbXMubGVuZ3RoOyBpKyspIHtcclxuICAgIGdlbmVyYXRlU2Nyb2xsYmFyKGVsbXNbaV0pO1xyXG4gIH1cclxufTtcclxudmFyIGdlbmVyYXRlU2Nyb2xsYmFyID0gZnVuY3Rpb24oZWxtKSB7XHJcbiAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIGlmIChcclxuICAgIGVsbS5zY3JvbGxiYXJJbml0IHx8XHJcbiAgICAoYXBwLmlzTW9iaWxlICYmIGVsbS5nZXRBdHRyaWJ1dGUoYXBwLnNjcm9sbEJhci5za2lwTW9iaWxlQXR0cikpXHJcbiAgKSB7XHJcbiAgICByZXR1cm47XHJcbiAgfVxyXG4gIHZhciBkYXRhSGVpZ2h0ID0gIWVsbS5nZXRBdHRyaWJ1dGUoYXBwLnNjcm9sbEJhci5oZWlnaHRBdHRyKVxyXG4gICAgPyBlbG0ub2Zmc2V0SGVpZ2h0XHJcbiAgICA6IGVsbS5nZXRBdHRyaWJ1dGUoYXBwLnNjcm9sbEJhci5oZWlnaHRBdHRyKTtcclxuXHJcbiAgZWxtLnN0eWxlLmhlaWdodCA9IGRhdGFIZWlnaHQ7XHJcbiAgZWxtLnNjcm9sbGJhckluaXQgPSB0cnVlO1xyXG5cclxuICBpZiAoYXBwLmlzTW9iaWxlKSB7XHJcbiAgICBlbG0uc3R5bGUub3ZlcmZsb3dYID0gXCJzY3JvbGxcIjtcclxuICB9IGVsc2Uge1xyXG4gICAgdmFyIGRhdGFXaGVlbFByb3BhZ2F0aW9uID0gZWxtLmdldEF0dHJpYnV0ZShcclxuICAgICAgYXBwLnNjcm9sbEJhci53aGVlbFByb3BhZ2F0aW9uQXR0clxyXG4gICAgKVxyXG4gICAgICA/IGVsbS5nZXRBdHRyaWJ1dGUoYXBwLnNjcm9sbEJhci53aGVlbFByb3BhZ2F0aW9uQXR0cilcclxuICAgICAgOiBmYWxzZTtcclxuXHJcbiAgICBpZiAoXHJcbiAgICAgIGVsbS5jbG9zZXN0KFwiLlwiICsgYXBwLnNpZGViYXIuY2xhc3MpICYmXHJcbiAgICAgIGVsbS5jbG9zZXN0KFwiLlwiICsgYXBwLnNpZGViYXIuY2xhc3MpLmxlbmd0aCAhPT0gMFxyXG4gICAgKSB7XHJcbiAgICAgIGFwcC5zaWRlYmFyLnNjcm9sbEJhci5kb20gPSBuZXcgUGVyZmVjdFNjcm9sbGJhcihlbG0sIHtcclxuICAgICAgICB3aGVlbFByb3BhZ2F0aW9uOiBkYXRhV2hlZWxQcm9wYWdhdGlvbixcclxuICAgICAgfSk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBuZXcgUGVyZmVjdFNjcm9sbGJhcihlbG0sIHtcclxuICAgICAgICB3aGVlbFByb3BhZ2F0aW9uOiBkYXRhV2hlZWxQcm9wYWdhdGlvbixcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIGVsbS5zZXRBdHRyaWJ1dGUoYXBwLmluaXQuYXR0ciwgdHJ1ZSk7XHJcbn07XHJcblxyXG4vKiAwMy4gSGFuZGxlIFNpZGViYXIgTWVudVxyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxudmFyIGhhbmRsZVNpZGViYXJNZW51VG9nZ2xlID0gZnVuY3Rpb24obWVudXMpIHtcclxuICBtZW51cy5tYXAoZnVuY3Rpb24obWVudSkge1xyXG4gICAgbWVudS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIHZhciB0YXJnZXQgPSB0aGlzLm5leHRFbGVtZW50U2libGluZztcclxuXHJcbiAgICAgIG1lbnVzLm1hcChmdW5jdGlvbihtKSB7XHJcbiAgICAgICAgdmFyIG90aGVyVGFyZ2V0ID0gbS5uZXh0RWxlbWVudFNpYmxpbmc7XHJcbiAgICAgICAgaWYgKG90aGVyVGFyZ2V0ICE9PSB0YXJnZXQpIHtcclxuICAgICAgICAgIG90aGVyVGFyZ2V0LnN0eWxlLmRpc3BsYXkgPSBcIm5vbmVcIjtcclxuICAgICAgICAgIG90aGVyVGFyZ2V0XHJcbiAgICAgICAgICAgIC5jbG9zZXN0KFwiLlwiICsgYXBwLnNpZGViYXIubWVudS5pdGVtQ2xhc3MpXHJcbiAgICAgICAgICAgIC5jbGFzc0xpc3QucmVtb3ZlKGFwcC5zaWRlYmFyLm1lbnUuZXhwYW5kQ2xhc3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICB2YXIgdGFyZ2V0SXRlbUVsbSA9IHRhcmdldC5jbG9zZXN0KFwiLlwiICsgYXBwLnNpZGViYXIubWVudS5pdGVtQ2xhc3MpO1xyXG5cclxuICAgICAgaWYgKFxyXG4gICAgICAgIHRhcmdldEl0ZW1FbG0uY2xhc3NMaXN0LmNvbnRhaW5zKGFwcC5zaWRlYmFyLm1lbnUuZXhwYW5kQ2xhc3MpIHx8XHJcbiAgICAgICAgKHRhcmdldEl0ZW1FbG0uY2xhc3NMaXN0LmNvbnRhaW5zKGFwcC5zaWRlYmFyLm1lbnUuYWN0aXZlQ2xhc3MpICYmXHJcbiAgICAgICAgICAhdGFyZ2V0LnN0eWxlLmRpc3BsYXkpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRhcmdldEl0ZW1FbG0uY2xhc3NMaXN0LnJlbW92ZShhcHAuc2lkZWJhci5tZW51LmV4cGFuZENsYXNzKTtcclxuICAgICAgICB0YXJnZXQuc3R5bGUuZGlzcGxheSA9IFwibm9uZVwiO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIHRhcmdldEl0ZW1FbG0uY2xhc3NMaXN0LmFkZChhcHAuc2lkZWJhci5tZW51LmV4cGFuZENsYXNzKTtcclxuICAgICAgICB0YXJnZXQuc3R5bGUuZGlzcGxheSA9IFwiYmxvY2tcIjtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9KTtcclxufTtcclxudmFyIGhhbmRsZVNpZGViYXJNZW51ID0gZnVuY3Rpb24oKSB7XHJcbiAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIHZhciBtZW51QmFzZVNlbGVjdG9yID1cclxuICAgIFwiLlwiICtcclxuICAgIGFwcC5zaWRlYmFyLmNsYXNzICtcclxuICAgIFwiIC5cIiArXHJcbiAgICBhcHAuc2lkZWJhci5tZW51LmNsYXNzICtcclxuICAgIFwiID4gLlwiICtcclxuICAgIGFwcC5zaWRlYmFyLm1lbnUuaXRlbUNsYXNzICtcclxuICAgIFwiLlwiICtcclxuICAgIGFwcC5zaWRlYmFyLm1lbnUuaGFzU3ViQ2xhc3M7XHJcbiAgdmFyIHN1Ym1lbnVCYXNlU2VsZWN0b3IgPVxyXG4gICAgXCIgPiAuXCIgK1xyXG4gICAgYXBwLnNpZGViYXIubWVudS5zdWJtZW51LmNsYXNzICtcclxuICAgIFwiID4gLlwiICtcclxuICAgIGFwcC5zaWRlYmFyLm1lbnUuaXRlbUNsYXNzICtcclxuICAgIFwiLlwiICtcclxuICAgIGFwcC5zaWRlYmFyLm1lbnUuaGFzU3ViQ2xhc3M7XHJcblxyXG4gIC8vIG1lbnVcclxuICB2YXIgbWVudUxpbmtTZWxlY3RvciA9XHJcbiAgICBtZW51QmFzZVNlbGVjdG9yICsgXCIgPiAuXCIgKyBhcHAuc2lkZWJhci5tZW51Lml0ZW1MaW5rQ2xhc3M7XHJcbiAgdmFyIG1lbnVzID0gW10uc2xpY2UuY2FsbChkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKG1lbnVMaW5rU2VsZWN0b3IpKTtcclxuICBoYW5kbGVTaWRlYmFyTWVudVRvZ2dsZShtZW51cyk7XHJcblxyXG4gIC8vIHN1Ym1lbnUgbHZsIDFcclxuICB2YXIgc3VibWVudUx2bDFTZWxlY3RvciA9IG1lbnVCYXNlU2VsZWN0b3IgKyBzdWJtZW51QmFzZVNlbGVjdG9yO1xyXG4gIHZhciBzdWJtZW51c0x2bDEgPSBbXS5zbGljZS5jYWxsKFxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcclxuICAgICAgc3VibWVudUx2bDFTZWxlY3RvciArIFwiID4gLlwiICsgYXBwLnNpZGViYXIubWVudS5pdGVtTGlua0NsYXNzXHJcbiAgICApXHJcbiAgKTtcclxuICBoYW5kbGVTaWRlYmFyTWVudVRvZ2dsZShzdWJtZW51c0x2bDEpO1xyXG5cclxuICAvLyBzdWJtZW51IGx2bCAyXHJcbiAgdmFyIHN1Ym1lbnVMdmwyU2VsZWN0b3IgPVxyXG4gICAgbWVudUJhc2VTZWxlY3RvciArIHN1Ym1lbnVCYXNlU2VsZWN0b3IgKyBzdWJtZW51QmFzZVNlbGVjdG9yO1xyXG4gIHZhciBzdWJtZW51c0x2bDIgPSBbXS5zbGljZS5jYWxsKFxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcclxuICAgICAgc3VibWVudUx2bDJTZWxlY3RvciArIFwiID4gLlwiICsgYXBwLnNpZGViYXIubWVudS5pdGVtTGlua0NsYXNzXHJcbiAgICApXHJcbiAgKTtcclxuICBoYW5kbGVTaWRlYmFyTWVudVRvZ2dsZShzdWJtZW51c0x2bDIpO1xyXG59O1xyXG5cclxuLyogMDQuIEhhbmRsZSBTaWRlYmFyIFNjcm9sbCBNZW1vcnlcclxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbnZhciBoYW5kbGVTaWRlYmFyU2Nyb2xsTWVtb3J5ID0gZnVuY3Rpb24oKSB7XHJcbiAgaWYgKCFhcHAuaXNNb2JpbGUpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGlmIChcclxuICAgICAgICB0eXBlb2YgU3RvcmFnZSAhPT0gXCJ1bmRlZmluZWRcIiAmJlxyXG4gICAgICAgIHR5cGVvZiBsb2NhbFN0b3JhZ2UgIT09IFwidW5kZWZpbmVkXCJcclxuICAgICAgKSB7XHJcbiAgICAgICAgdmFyIGVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgICBcIi5cIiArIGFwcC5zaWRlYmFyLmNsYXNzICsgXCIgW1wiICsgYXBwLnNjcm9sbEJhci5hdHRyICsgXCJdXCJcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBlbG0ub25zY3JvbGwgPSBmdW5jdGlvbigpIHtcclxuICAgICAgICAgIGxvY2FsU3RvcmFnZS5zZXRJdGVtKFxyXG4gICAgICAgICAgICBhcHAuc2lkZWJhci5zY3JvbGxCYXIubG9jYWxTdG9yYWdlLFxyXG4gICAgICAgICAgICB0aGlzLnNjcm9sbFRvcFxyXG4gICAgICAgICAgKTtcclxuICAgICAgICB9O1xyXG4gICAgICAgIHZhciBkZWZhdWx0U2Nyb2xsID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oXHJcbiAgICAgICAgICBhcHAuc2lkZWJhci5zY3JvbGxCYXIubG9jYWxTdG9yYWdlXHJcbiAgICAgICAgKTtcclxuICAgICAgICBpZiAoZGVmYXVsdFNjcm9sbCkge1xyXG4gICAgICAgICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICAgICAgXCIuXCIgKyBhcHAuc2lkZWJhci5jbGFzcyArIFwiIFtcIiArIGFwcC5zY3JvbGxCYXIuYXR0ciArIFwiXVwiXHJcbiAgICAgICAgICApLnNjcm9sbFRvcCA9IGRlZmF1bHRTY3JvbGw7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmxvZyhlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG59O1xyXG5cclxuLyogMDUuIEhhbmRsZSBDYXJkIEFjdGlvblxyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxudmFyIGhhbmRsZUNhcmRBY3Rpb24gPSBmdW5jdGlvbigpIHtcclxuICBcInVzZSBzdHJpY3RcIjtcclxuXHJcbiAgaWYgKGFwcC5jYXJkLmV4cGFuZC5zdGF0dXMpIHtcclxuICAgIHJldHVybiBmYWxzZTtcclxuICB9XHJcbiAgYXBwLmNhcmQuZXhwYW5kLnN0YXR1cyA9IHRydWU7XHJcblxyXG4gIC8vIGV4cGFuZFxyXG4gIHZhciBleHBhbmRUb2dnbGVyTGlzdCA9IFtdLnNsaWNlLmNhbGwoXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW1wiICsgYXBwLmNhcmQuZXhwYW5kLnRvZ2dsZUF0dHIgKyBcIl1cIilcclxuICApO1xyXG4gIHZhciBleHBhbmRUb2dnbGVyVG9vbHRpcExpc3QgPSBleHBhbmRUb2dnbGVyTGlzdC5tYXAoZnVuY3Rpb24oXHJcbiAgICBleHBhbmRUb2dnbGVyRWxcclxuICApIHtcclxuICAgIGV4cGFuZFRvZ2dsZXJFbC5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICB2YXIgdGFyZ2V0ID0gdGhpcy5jbG9zZXN0KFwiLmNhcmRcIik7XHJcbiAgICAgIHZhciB0YXJnZXRDbGFzcyA9IGFwcC5jYXJkLmV4cGFuZC5jbGFzcztcclxuICAgICAgdmFyIHRhcmdldFRvcCA9IDQwO1xyXG5cclxuICAgICAgaWYgKFxyXG4gICAgICAgIGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0LmNvbnRhaW5zKHRhcmdldENsYXNzKSAmJlxyXG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0Q2xhc3MpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHRhcmdldC5yZW1vdmVBdHRyaWJ1dGUoXCJzdHlsZVwiKTtcclxuICAgICAgICB0YXJnZXQuY2xhc3NMaXN0LnJlbW92ZSh0YXJnZXRDbGFzcyk7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKHRhcmdldENsYXNzKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5hZGQodGFyZ2V0Q2xhc3MpO1xyXG4gICAgICAgIHRhcmdldC5jbGFzc0xpc3QuYWRkKHRhcmdldENsYXNzKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgd2luZG93LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwicmVzaXplXCIpKTtcclxuICAgIH07XHJcblxyXG4gICAgcmV0dXJuIG5ldyBib290c3RyYXAuVG9vbHRpcChleHBhbmRUb2dnbGVyRWwsIHtcclxuICAgICAgdGl0bGU6IGFwcC5jYXJkLmV4cGFuZC50b2dnbGVUaXRsZSxcclxuICAgICAgcGxhY2VtZW50OiBcImJvdHRvbVwiLFxyXG4gICAgICB0cmlnZ2VyOiBcImhvdmVyXCIsXHJcbiAgICAgIGNvbnRhaW5lcjogXCJib2R5XCIsXHJcbiAgICB9KTtcclxuICB9KTtcclxufTtcclxuXHJcbi8qIDA2LiBIYW5kbGUgVG9vbHRpcCAmIFBvcG92ZXIgQWN0aXZhdGlvblxyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxudmFyIGhhbmRlbFRvb2x0aXBQb3BvdmVyQWN0aXZhdGlvbiA9IGZ1bmN0aW9uKCkge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICB2YXIgdG9vbHRpcFRyaWdnZXJMaXN0ID0gW10uc2xpY2UuY2FsbChcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbXCIgKyBhcHAuYm9vdHN0cmFwLnRvb2x0aXAuYXR0ciArIFwiXVwiKVxyXG4gICk7XHJcbiAgdmFyIHRvb2x0aXBMaXN0ID0gdG9vbHRpcFRyaWdnZXJMaXN0Lm1hcChmdW5jdGlvbih0b29sdGlwVHJpZ2dlckVsKSB7XHJcbiAgICByZXR1cm4gbmV3IGJvb3RzdHJhcC5Ub29sdGlwKHRvb2x0aXBUcmlnZ2VyRWwpO1xyXG4gIH0pO1xyXG5cclxuICB2YXIgcG9wb3ZlclRyaWdnZXJMaXN0ID0gW10uc2xpY2UuY2FsbChcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbXCIgKyBhcHAuYm9vdHN0cmFwLnBvcG92ZXIuYXR0ciArIFwiXVwiKVxyXG4gICk7XHJcbiAgdmFyIHBvcG92ZXJMaXN0ID0gcG9wb3ZlclRyaWdnZXJMaXN0Lm1hcChmdW5jdGlvbihwb3BvdmVyVHJpZ2dlckVsKSB7XHJcbiAgICByZXR1cm4gbmV3IGJvb3RzdHJhcC5Qb3BvdmVyKHBvcG92ZXJUcmlnZ2VyRWwpO1xyXG4gIH0pO1xyXG59O1xyXG5cclxuLyogMDcuIEhhbmRsZSBTY3JvbGwgdG8gVG9wIEJ1dHRvblxyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxudmFyIGhhbmRsZVNjcm9sbFRvVG9wQnV0dG9uID0gZnVuY3Rpb24oKSB7XHJcbiAgXCJ1c2Ugc3RyaWN0XCI7XHJcblxyXG4gIHZhciBlbG1UcmlnZ2VyTGlzdCA9IFtdLnNsaWNlLmNhbGwoXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW1wiICsgYXBwLnNjcm9sbFRvVG9wQnRuLnRvZ2dsZUF0dHIgKyBcIl1cIilcclxuICApO1xyXG5cclxuICBkb2N1bWVudC5vbnNjcm9sbCA9IGZ1bmN0aW9uKCkge1xyXG4gICAgdmFyIGRvYyA9IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudDtcclxuICAgIHZhciB0b3RhbFNjcm9sbCA9XHJcbiAgICAgICh3aW5kb3cucGFnZVlPZmZzZXQgfHwgZG9jLnNjcm9sbFRvcCkgLSAoZG9jLmNsaWVudFRvcCB8fCAwKTtcclxuICAgIHZhciBlbG1MaXN0ID0gZWxtVHJpZ2dlckxpc3QubWFwKGZ1bmN0aW9uKGVsbSkge1xyXG4gICAgICBpZiAodG90YWxTY3JvbGwgPj0gYXBwLnNjcm9sbFRvVG9wQnRuLmhlaWdodFNob3cpIHtcclxuICAgICAgICBpZiAoIWVsbS5jbGFzc0xpc3QuY29udGFpbnMoYXBwLnNjcm9sbFRvVG9wQnRuLnNob3dDbGFzcykpIHtcclxuICAgICAgICAgIGVsbS5jbGFzc0xpc3QuYWRkKGFwcC5zY3JvbGxUb1RvcEJ0bi5zaG93Q2xhc3MpO1xyXG4gICAgICAgIH1cclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICBlbG0uY2xhc3NMaXN0LnJlbW92ZShhcHAuc2Nyb2xsVG9Ub3BCdG4uc2hvd0NsYXNzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcblxyXG4gICAgdmFyIGVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoYXBwLmlkKVswXTtcclxuXHJcbiAgICBpZiAodG90YWxTY3JvbGwgPiAwKSB7XHJcbiAgICAgIGVsbS5jbGFzc0xpc3QuYWRkKGFwcC5oZWFkZXIuaGFzU2Nyb2xsQ2xhc3MpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgZWxtLmNsYXNzTGlzdC5yZW1vdmUoYXBwLmhlYWRlci5oYXNTY3JvbGxDbGFzcyk7XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgdmFyIGVsbUxpc3QgPSBlbG1UcmlnZ2VyTGlzdC5tYXAoZnVuY3Rpb24oZWxtKSB7XHJcbiAgICBlbG0ub25jbGljayA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgd2luZG93LnNjcm9sbFRvKHsgdG9wOiAwLCBiZWhhdmlvcjogXCJzbW9vdGhcIiB9KTtcclxuICAgIH07XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vKiAwOC4gSGFuZGxlIGhleFRvUmdiYVxyXG4tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0gKi9cclxudmFyIGhleFRvUmdiYSA9IGZ1bmN0aW9uKGhleCwgdHJhbnNwYXJlbnQgPSAxKSB7XHJcbiAgdmFyIGM7XHJcbiAgaWYgKC9eIyhbQS1GYS1mMC05XXszfSl7MSwyfSQvLnRlc3QoaGV4KSkge1xyXG4gICAgYyA9IGhleC5zdWJzdHJpbmcoMSkuc3BsaXQoXCJcIik7XHJcbiAgICBpZiAoYy5sZW5ndGggPT0gMykge1xyXG4gICAgICBjID0gW2NbMF0sIGNbMF0sIGNbMV0sIGNbMV0sIGNbMl0sIGNbMl1dO1xyXG4gICAgfVxyXG4gICAgYyA9IFwiMHhcIiArIGMuam9pbihcIlwiKTtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIFwicmdiYShcIiArXHJcbiAgICAgIFsoYyA+PiAxNikgJiAyNTUsIChjID4+IDgpICYgMjU1LCBjICYgMjU1XS5qb2luKFwiLFwiKSArXHJcbiAgICAgIFwiLFwiICtcclxuICAgICAgdHJhbnNwYXJlbnQgK1xyXG4gICAgICBcIilcIlxyXG4gICAgKTtcclxuICB9XHJcbiAgdGhyb3cgbmV3IEVycm9yKFwiQmFkIEhleFwiKTtcclxufTtcclxuXHJcbi8qIDA5LiBIYW5kbGUgU2Nyb2xsIFRvXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgaGFuZGxlU2Nyb2xsVG8gPSBmdW5jdGlvbigpIHtcclxuICB2YXIgZWxtVHJpZ2dlckxpc3QgPSBbXS5zbGljZS5jYWxsKFxyXG4gICAgZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIltcIiArIGFwcC5zY3JvbGxUby5hdHRyICsgXCJdXCIpXHJcbiAgKTtcclxuICB2YXIgZWxtTGlzdCA9IGVsbVRyaWdnZXJMaXN0Lm1hcChmdW5jdGlvbihlbG0pIHtcclxuICAgIGVsbS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICB2YXIgdGFyZ2V0QXR0ciA9IGVsbS5nZXRBdHRyaWJ1dGUoYXBwLnNjcm9sbFRvLnRhcmdldClcclxuICAgICAgICA/IHRoaXMuZ2V0QXR0cmlidXRlKGFwcC5zY3JvbGxUby50YXJnZXQpXHJcbiAgICAgICAgOiB0aGlzLmdldEF0dHJpYnV0ZShhcHAuc2Nyb2xsVG8ubGlua1RhcmdldCk7XHJcbiAgICAgIHZhciB0YXJnZXRFbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKHRhcmdldEF0dHIpWzBdO1xyXG4gICAgICB2YXIgdGFyZ2V0SGVhZGVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChhcHAuaGVhZGVyLmlkKVswXTtcclxuICAgICAgdmFyIHRhcmdldEhlaWdodCA9IHRhcmdldEhlYWRlci5vZmZzZXRIZWlnaHQ7XHJcbiAgICAgIGlmICh0YXJnZXRFbG0pIHtcclxuICAgICAgICB2YXIgdGFyZ2V0VG9wID0gdGFyZ2V0RWxtLm9mZnNldFRvcCAtIHRhcmdldEhlaWdodCAtIDI0O1xyXG4gICAgICAgIHdpbmRvdy5zY3JvbGxUbyh7IHRvcDogdGFyZ2V0VG9wLCBiZWhhdmlvcjogXCJzbW9vdGhcIiB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9KTtcclxufTtcclxuXHJcbi8qIDEwLiBIYW5kbGUgVG9nZ2xlIENsYXNzXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgaGFuZGxlVG9nZ2xlQ2xhc3MgPSBmdW5jdGlvbigpIHtcclxuICB2YXIgZWxtTGlzdCA9IFtdLnNsaWNlLmNhbGwoXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiW1wiICsgYXBwLnRvZ2dsZUNsYXNzLnRvZ2dsZUF0dHIgKyBcIl1cIilcclxuICApO1xyXG5cclxuICBlbG1MaXN0Lm1hcChmdW5jdGlvbihlbG0pIHtcclxuICAgIGVsbS5vbmNsaWNrID0gZnVuY3Rpb24oZSkge1xyXG4gICAgICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gICAgICB2YXIgdGFyZ2V0VG9nZ2xlQ2xhc3MgPSB0aGlzLmdldEF0dHJpYnV0ZShhcHAudG9nZ2xlQ2xhc3MudG9nZ2xlQXR0cik7XHJcbiAgICAgIHZhciB0YXJnZXREaXNtaXNzQ2xhc3MgPSB0aGlzLmdldEF0dHJpYnV0ZShhcHAuZGlzbWlzc0NsYXNzLnRvZ2dsZUF0dHIpO1xyXG4gICAgICB2YXIgdGFyZ2V0VG9nZ2xlRWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICB0aGlzLmdldEF0dHJpYnV0ZShhcHAudG9nZ2xlQ2xhc3MudGFyZ2V0QXR0cilcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGlmICghdGFyZ2V0RGlzbWlzc0NsYXNzKSB7XHJcbiAgICAgICAgaWYgKHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0VG9nZ2xlQ2xhc3MpKSB7XHJcbiAgICAgICAgICB0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LnJlbW92ZSh0YXJnZXRUb2dnbGVDbGFzcyk7XHJcbiAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgIHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuYWRkKHRhcmdldFRvZ2dsZUNsYXNzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgIXRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0VG9nZ2xlQ2xhc3MpICYmXHJcbiAgICAgICAgICAhdGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5jb250YWlucyh0YXJnZXREaXNtaXNzQ2xhc3MpXHJcbiAgICAgICAgKSB7XHJcbiAgICAgICAgICBpZiAodGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5jb250YWlucyh0YXJnZXRUb2dnbGVDbGFzcykpIHtcclxuICAgICAgICAgICAgdGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5yZW1vdmUodGFyZ2V0VG9nZ2xlQ2xhc3MpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5hZGQodGFyZ2V0VG9nZ2xlQ2xhc3MpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBpZiAodGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5jb250YWlucyh0YXJnZXRUb2dnbGVDbGFzcykpIHtcclxuICAgICAgICAgICAgdGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5yZW1vdmUodGFyZ2V0VG9nZ2xlQ2xhc3MpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5hZGQodGFyZ2V0VG9nZ2xlQ2xhc3MpO1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgaWYgKHRhcmdldFRvZ2dsZUVsbS5jbGFzc0xpc3QuY29udGFpbnModGFyZ2V0RGlzbWlzc0NsYXNzKSkge1xyXG4gICAgICAgICAgICB0YXJnZXRUb2dnbGVFbG0uY2xhc3NMaXN0LnJlbW92ZSh0YXJnZXREaXNtaXNzQ2xhc3MpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgdGFyZ2V0VG9nZ2xlRWxtLmNsYXNzTGlzdC5hZGQodGFyZ2V0RGlzbWlzc0NsYXNzKTtcclxuICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfSk7XHJcbn07XHJcblxyXG4vKiAxMS4gSGFuZGxlIFRoZW1lIFBhbmVsXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgaGFuZGxlVGhlbWVQYW5lbCA9IGZ1bmN0aW9uKCkge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICAvLyAxMi4xIFRoZW1lIFBhbmVsIC0gVG9nZ2xlIC8gRGlzbWlzc1xyXG4gIHZhciBlbG1MaXN0ID0gW10uc2xpY2UuY2FsbChcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJbXCIgKyBhcHAudGhlbWVQYW5lbC50b2dnbGVBdHRyICsgXCJdXCIpXHJcbiAgKTtcclxuXHJcbiAgZWxtTGlzdC5tYXAoZnVuY3Rpb24oZWxtKSB7XHJcbiAgICBlbG0ub25jbGljayA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgdmFyIHRhcmdldENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuXCIgKyBhcHAudGhlbWVQYW5lbC5jbGFzcyk7XHJcbiAgICAgIHZhciB0YXJnZXRFeHBhbmQgPSBmYWxzZTtcclxuXHJcbiAgICAgIGlmICh0YXJnZXRDb250YWluZXIuY2xhc3NMaXN0LmNvbnRhaW5zKGFwcC50aGVtZVBhbmVsLmFjdGl2ZUNsYXNzKSkge1xyXG4gICAgICAgIHRhcmdldENvbnRhaW5lci5jbGFzc0xpc3QucmVtb3ZlKGFwcC50aGVtZVBhbmVsLmFjdGl2ZUNsYXNzKTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICB0YXJnZXRDb250YWluZXIuY2xhc3NMaXN0LmFkZChhcHAudGhlbWVQYW5lbC5hY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgdGFyZ2V0RXhwYW5kID0gdHJ1ZTtcclxuICAgICAgfVxyXG4gICAgICBpZiAoQ29va2llcykge1xyXG4gICAgICAgIENvb2tpZXMuc2V0KGFwcC50aGVtZVBhbmVsLmNvb2tpZU5hbWUsIHRhcmdldEV4cGFuZCk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgfSk7XHJcblxyXG4gIC8vIDEyLjIgVGhlbWUgUGFuZWwgLSBQYWdlIExvYWQgQ29va2llc1xyXG4gIC8vIGlmIChDb29raWVzKSB7XHJcbiAgLy8gICB2YXIgdGhlbWVQYW5lbEV4cGFuZCA9IENvb2tpZXMuZ2V0KGFwcC50aGVtZVBhbmVsLmNvb2tpZU5hbWUpO1xyXG5cclxuICAvLyAgIGlmICh0aGVtZVBhbmVsRXhwYW5kID09IFwidHJ1ZVwiIHx8IHR5cGVvZiB0aGVtZVBhbmVsRXhwYW5kID09IFwidW5kZWZpbmVkXCIpIHtcclxuICAvLyAgICAgdmFyIGVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJbXCIgKyBhcHAudGhlbWVQYW5lbC50b2dnbGVBdHRyICsgXCJdXCIpO1xyXG4gIC8vICAgICBlbG0uY2xpY2soKTtcclxuICAvLyAgIH1cclxuICAvLyB9XHJcblxyXG4gIC8vIDEyLjMgVGhlbWUgUGFuZWwgLSBUaGVtZSBTZWxlY3RvclxyXG4gIHZhciBlbG1MaXN0ID0gW10uc2xpY2UuY2FsbChcclxuICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXHJcbiAgICAgIFwiLlwiICsgYXBwLnRoZW1lUGFuZWwuY2xhc3MgKyBcIiBbXCIgKyBhcHAudGhlbWVQYW5lbC50aGVtZS50b2dnbGVBdHRyICsgXCJdXCJcclxuICAgIClcclxuICApO1xyXG4gIGVsbUxpc3QubWFwKGZ1bmN0aW9uKGVsbSkge1xyXG4gICAgZWxtLm9uY2xpY2sgPSBmdW5jdGlvbigpIHtcclxuICAgICAgZm9yICh2YXIgeCA9IDA7IHggPCBkb2N1bWVudC5ib2R5LmNsYXNzTGlzdC5sZW5ndGg7IHgrKykge1xyXG4gICAgICAgIHZhciB0YXJnZXRDbGFzcyA9IGRvY3VtZW50LmJvZHkuY2xhc3NMaXN0W3hdO1xyXG4gICAgICAgIGlmICh0YXJnZXRDbGFzcy5zZWFyY2goXCJ0aGVtZS1cIikgPiAtMSkge1xyXG4gICAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QucmVtb3ZlKHRhcmdldENsYXNzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciB0YXJnZXRUaGVtZSA9IHRoaXMuZ2V0QXR0cmlidXRlKGFwcC50aGVtZVBhbmVsLnRoZW1lLmNsYXNzQXR0cik7XHJcbiAgICAgIHZhciB0YXJnZXRUaGVtZUxpc3QgPSBbXS5zbGljZS5jYWxsKFxyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXHJcbiAgICAgICAgICBcIi5cIiArXHJcbiAgICAgICAgICAgIGFwcC50aGVtZVBhbmVsLmNsYXNzICtcclxuICAgICAgICAgICAgXCIgW1wiICtcclxuICAgICAgICAgICAgYXBwLnRoZW1lUGFuZWwudGhlbWUudG9nZ2xlQXR0ciArXHJcbiAgICAgICAgICAgIFwiXVwiXHJcbiAgICAgICAgKVxyXG4gICAgICApO1xyXG5cclxuICAgICAgaWYgKHRhcmdldFRoZW1lKSB7XHJcbiAgICAgICAgZG9jdW1lbnQuYm9keS5jbGFzc0xpc3QuYWRkKHRhcmdldFRoZW1lKTtcclxuICAgICAgfVxyXG4gICAgICB0YXJnZXRUaGVtZUxpc3QubWFwKGZ1bmN0aW9uKHRhcmdldEVsbSkge1xyXG4gICAgICAgIGlmIChcclxuICAgICAgICAgIHRhcmdldEVsbS5nZXRBdHRyaWJ1dGUoYXBwLnRoZW1lUGFuZWwudGhlbWUuY2xhc3NBdHRyKSAhPSB0YXJnZXRUaGVtZVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgdGFyZ2V0RWxtXHJcbiAgICAgICAgICAgIC5jbG9zZXN0KFwiLlwiICsgYXBwLnRoZW1lUGFuZWwudGhlbWVMaXN0SXRlbUNMYXNzKVxyXG4gICAgICAgICAgICAuY2xhc3NMaXN0LnJlbW92ZShhcHAudGhlbWVQYW5lbC50aGVtZS5hY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHRoaXMuY2xvc2VzdChcIi5cIiArIGFwcC50aGVtZVBhbmVsLnRoZW1lTGlzdEl0ZW1DTGFzcykuY2xhc3NMaXN0LmFkZChcclxuICAgICAgICBhcHAudGhlbWVQYW5lbC50aGVtZS5hY3RpdmVDbGFzc1xyXG4gICAgICApO1xyXG5cclxuICAgICAgaWYgKENvb2tpZXMpIHtcclxuICAgICAgICBDb29raWVzLnNldChhcHAudGhlbWVQYW5lbC50aGVtZS5jb29raWVOYW1lLCB0YXJnZXRUaGVtZSk7XHJcbiAgICAgICAgYXBwLmNvbG9yLnRoZW1lID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFxyXG4gICAgICAgICAgXCItLWJzLXRoZW1lXCJcclxuICAgICAgICApO1xyXG4gICAgICAgIGFwcC5jb2xvci50aGVtZVJnYiA9IGdldENvbXB1dGVkU3R5bGUoZG9jdW1lbnQuYm9keSkuZ2V0UHJvcGVydHlWYWx1ZShcclxuICAgICAgICAgIFwiLS1icy10aGVtZS1yZ2JcIlxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIGRvY3VtZW50LmRpc3BhdGNoRXZlbnQobmV3IEV2ZW50KFwidGhlbWUtcmVsb2FkXCIpKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICB9KTtcclxuXHJcbiAgaWYgKENvb2tpZXMpIHtcclxuICAgIGlmIChDb29raWVzLmdldChhcHAudGhlbWVQYW5lbC50aGVtZS5jb29raWVOYW1lKSkge1xyXG4gICAgICB2YXIgdGFyZ2V0RWxtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcclxuICAgICAgICBcIi5cIiArXHJcbiAgICAgICAgICBhcHAudGhlbWVQYW5lbC5jbGFzcyArXHJcbiAgICAgICAgICBcIiBbXCIgK1xyXG4gICAgICAgICAgYXBwLnRoZW1lUGFuZWwudGhlbWUudG9nZ2xlQXR0ciArXHJcbiAgICAgICAgICBcIl1cIiArXHJcbiAgICAgICAgICBcIltcIiArXHJcbiAgICAgICAgICBhcHAudGhlbWVQYW5lbC50aGVtZS5jbGFzc0F0dHIgK1xyXG4gICAgICAgICAgJz1cIicgK1xyXG4gICAgICAgICAgQ29va2llcy5nZXQoYXBwLnRoZW1lUGFuZWwudGhlbWUuY29va2llTmFtZSkgK1xyXG4gICAgICAgICAgJ1wiXSdcclxuICAgICAgKTtcclxuICAgICAgdGFyZ2V0RWxtLmNsaWNrKCk7XHJcblxyXG4gICAgICBhcHAuY29sb3IudGhlbWUgPSBnZXRDb21wdXRlZFN0eWxlKGRvY3VtZW50LmJvZHkpLmdldFByb3BlcnR5VmFsdWUoXHJcbiAgICAgICAgXCItLWJzLXRoZW1lXCJcclxuICAgICAgKTtcclxuICAgICAgYXBwLmNvbG9yLnRoZW1lUmdiID0gZ2V0Q29tcHV0ZWRTdHlsZShkb2N1bWVudC5ib2R5KS5nZXRQcm9wZXJ0eVZhbHVlKFxyXG4gICAgICAgIFwiLS1icy10aGVtZS1yZ2JcIlxyXG4gICAgICApO1xyXG5cclxuICAgICAgZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgRXZlbnQoXCJ0aGVtZS1yZWxvYWRcIikpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLy8gMTIuNCBUaGVtZSBQYW5lbCAtIEJhY2tncm91bmQgU2VsZWN0b3JcclxuICB2YXIgZWxtTGlzdCA9IFtdLnNsaWNlLmNhbGwoXHJcbiAgICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFxyXG4gICAgICBcIi5cIiArXHJcbiAgICAgICAgYXBwLnRoZW1lUGFuZWwuY2xhc3MgK1xyXG4gICAgICAgIFwiIFtcIiArXHJcbiAgICAgICAgYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlci50b2dnbGVBdHRyICtcclxuICAgICAgICBcIl1cIlxyXG4gICAgKVxyXG4gICk7XHJcbiAgZWxtTGlzdC5tYXAoZnVuY3Rpb24oZWxtKSB7XHJcbiAgICBlbG0ub25jbGljayA9IGZ1bmN0aW9uKGUpIHtcclxuICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgICAgdmFyIGh0bWxFbG0gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiaHRtbFwiKTtcclxuICAgICAgdmFyIHRhcmdldFRoZW1lID0gdGhpcy5nZXRBdHRyaWJ1dGUoYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlci5jbGFzc0F0dHIpO1xyXG4gICAgICBmb3IgKHZhciB4ID0gMDsgeCA8IGRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5jbGFzc0xpc3QubGVuZ3RoOyB4KyspIHtcclxuICAgICAgICB2YXIgdGFyZ2V0Q2xhc3MgPSBkb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuY2xhc3NMaXN0W3hdO1xyXG4gICAgICAgIGlmICh0YXJnZXRDbGFzcy5zZWFyY2goXCJiZy1jb3Zlci1cIikgPiAtMSkge1xyXG4gICAgICAgICAgaHRtbEVsbS5jbGFzc0xpc3QucmVtb3ZlKHRhcmdldENsYXNzKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmICh0YXJnZXRUaGVtZSkge1xyXG4gICAgICAgIGh0bWxFbG0uY2xhc3NMaXN0LmFkZCh0YXJnZXRUaGVtZSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHZhciB0YXJnZXRDb3Zlckxpc3QgPSBbXS5zbGljZS5jYWxsKFxyXG4gICAgICAgIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXHJcbiAgICAgICAgICBcIi5cIiArXHJcbiAgICAgICAgICAgIGFwcC50aGVtZVBhbmVsLmNsYXNzICtcclxuICAgICAgICAgICAgXCIgW1wiICtcclxuICAgICAgICAgICAgYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlci50b2dnbGVBdHRyICtcclxuICAgICAgICAgICAgXCJdXCJcclxuICAgICAgICApXHJcbiAgICAgICk7XHJcbiAgICAgIHRhcmdldENvdmVyTGlzdC5tYXAoZnVuY3Rpb24odGFyZ2V0RWxtKSB7XHJcbiAgICAgICAgaWYgKFxyXG4gICAgICAgICAgdGFyZ2V0RWxtLmdldEF0dHJpYnV0ZShhcHAudGhlbWVQYW5lbC50aGVtZUNvdmVyLnRvZ2dsZUF0dHIpICE9XHJcbiAgICAgICAgICB0YXJnZXRUaGVtZVxyXG4gICAgICAgICkge1xyXG4gICAgICAgICAgdGFyZ2V0RWxtXHJcbiAgICAgICAgICAgIC5jbG9zZXN0KFwiLlwiICsgYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlckl0ZW1DbGFzcylcclxuICAgICAgICAgICAgLmNsYXNzTGlzdC5yZW1vdmUoYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlci5hY3RpdmVDbGFzcyk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHRoaXMuY2xvc2VzdChcIi5cIiArIGFwcC50aGVtZVBhbmVsLnRoZW1lQ292ZXJJdGVtQ2xhc3MpLmNsYXNzTGlzdC5hZGQoXHJcbiAgICAgICAgYXBwLnRoZW1lUGFuZWwudGhlbWVDb3Zlci5hY3RpdmVDbGFzc1xyXG4gICAgICApO1xyXG4gICAgICBpZiAoQ29va2llcykge1xyXG4gICAgICAgIENvb2tpZXMuc2V0KGFwcC50aGVtZVBhbmVsLnRoZW1lQ292ZXIuY29va2llTmFtZSwgdGFyZ2V0VGhlbWUpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gIH0pO1xyXG5cclxuICBpZiAoQ29va2llcykge1xyXG4gICAgaWYgKENvb2tpZXMuZ2V0KGFwcC50aGVtZVBhbmVsLnRoZW1lQ292ZXIuY29va2llTmFtZSkpIHtcclxuICAgICAgdmFyIHRhcmdldEVsbSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXHJcbiAgICAgICAgXCIuXCIgK1xyXG4gICAgICAgICAgYXBwLnRoZW1lUGFuZWwuY2xhc3MgK1xyXG4gICAgICAgICAgXCIgW1wiICtcclxuICAgICAgICAgIGFwcC50aGVtZVBhbmVsLnRoZW1lQ292ZXIudG9nZ2xlQXR0ciArXHJcbiAgICAgICAgICBcIl1cIiArXHJcbiAgICAgICAgICBcIltcIiArXHJcbiAgICAgICAgICBhcHAudGhlbWVQYW5lbC50aGVtZUNvdmVyLmNsYXNzQXR0ciArXHJcbiAgICAgICAgICAnPVwiJyArXHJcbiAgICAgICAgICBDb29raWVzLmdldChhcHAudGhlbWVQYW5lbC50aGVtZUNvdmVyLmNvb2tpZU5hbWUpICtcclxuICAgICAgICAgICdcIl0nXHJcbiAgICAgICk7XHJcbiAgICAgIGlmICh0YXJnZXRFbG0pIHtcclxuICAgICAgICB0YXJnZXRFbG0uY2xpY2soKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG4gIH1cclxufTtcclxuXHJcbi8qIDEyLiBBcHBsaWNhdGlvbiBDb250cm9sbGVyXHJcbi0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSAqL1xyXG52YXIgQXBwID0gKGZ1bmN0aW9uKCkge1xyXG4gIFwidXNlIHN0cmljdFwiO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgLy9tYWluIGZ1bmN0aW9uXHJcbiAgICBpbml0OiBmdW5jdGlvbigpIHtcclxuICAgICAgdGhpcy5pbml0Q29tcG9uZW50KCk7XHJcbiAgICAgIHRoaXMuaW5pdFNpZGViYXIoKTtcclxuICAgIH0sXHJcbiAgICBpbml0U2lkZWJhcjogZnVuY3Rpb24oKSB7XHJcbiAgICAgIGhhbmRsZVNpZGViYXJNZW51KCk7XHJcbiAgICAgIGhhbmRsZVNpZGViYXJTY3JvbGxNZW1vcnkoKTtcclxuICAgIH0sXHJcbiAgICBpbml0Q29tcG9uZW50OiBmdW5jdGlvbigpIHtcclxuICAgICAgaGFuZGxlU2Nyb2xsYmFyKCk7XHJcbiAgICAgIGhhbmRsZVNjcm9sbFRvVG9wQnV0dG9uKCk7XHJcbiAgICAgIGhhbmRsZVNjcm9sbFRvKCk7XHJcbiAgICAgIGhhbmRsZUNhcmRBY3Rpb24oKTtcclxuICAgICAgaGFuZGVsVG9vbHRpcFBvcG92ZXJBY3RpdmF0aW9uKCk7XHJcbiAgICAgIGhhbmRsZVRvZ2dsZUNsYXNzKCk7XHJcbiAgICAgIGhhbmRsZVRoZW1lUGFuZWwoKTtcclxuICAgIH0sXHJcbiAgICBzY3JvbGxUb3A6IGZ1bmN0aW9uKCkge1xyXG4gICAgICB3aW5kb3cuc2Nyb2xsVG8oeyB0b3A6IDAsIGJlaGF2aW9yOiBcInNtb290aFwiIH0pO1xyXG4gICAgfSxcclxuICB9O1xyXG59KSgpO1xyXG5cclxuLyogMTMuIEluaXRpYWxpc2VcclxuLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJET01Db250ZW50TG9hZGVkXCIsIGZ1bmN0aW9uKCkge1xyXG4gIEFwcC5pbml0KCk7XHJcbn0pO1xyXG4iXX0=
